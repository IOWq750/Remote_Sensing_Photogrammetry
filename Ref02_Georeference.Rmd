# Географическая привязка {#georeference}

## Географическая привязка в ArcGIS Pro {#georeference-arcgis}

### Привязка на основе ввода координат

Создайте новый проект и сохраните его. Задайте систему координат датафрейма (карты) – для этого зайдите в свойства **Map** и перейдите во вкладку **Coordinate Systems**, раскройте список **Projected coordinate system** и выберите нужную СК.


![Свойства системы координат карты](images/Ref02/Arc_mapCRS.png)


Добавьте из панели каталога растр, который необходимо привязать.Выделите его в списке слоев и во вкладке **Imagery** нажмите на кнопку **Georeference**.


![Открытие панели привязки](images/Ref02/Arc_georeference.png)


Открытая панель привязки состоит из нескольких кнопок. Убедитесь, что у вас нажата кнопка **Auto Apply**, которая позволяет трансформировать изображение на лету.


![Панель привязки](images/Ref02/Arc_georef_panel.png)


Нажмите на кнопку **Add Control Points** ![](images/Ref02/Arc_add_control_points.png) и установите опорную точку в нужном месте на карте. После этого вам будет предложено установить соответственную точку на референцном слое или ввести заданные координаты для точки – для этого щёлкните правой кнопкой мыши, после чего откроется окошко для ввода координат.


![Окно ввода координат опорной точки](images/Ref02/Arc_target_coords.png)


Если нажать на кнопку **Control Point Table** ![](images/Ref02/Arc_control_points_tab.png), то откроется таблица, где будут показаны все установленные опорные точки с их координатами в исходной и референцной системе координат. В этой же таблице указываются ошибки (невязки) общая и по отдельным координатам. Слева можно включать и выключать точки из расчёта. Когда точка выключена из расчёта, она превращается из опорной в контрольную.


![Таблица координат опорных точек](images/Ref02/Arc_table.png)


Установив необходимое количество точек, вы можете нажать на кнопку **Transformation** ![](images/Ref02/Arc_transformation.png)и выбрать тип трансформации. После установки опорных точек и выбора типа трансформации можно запустить процесс трансформирования и сохранения нового изображения, нажав на кнопку ![](images/Ref02/Arc_save_as_new.png).


![Окно сохранения трансформированного изображения](images/Ref02/Arc_export_raster.png)


Обратите внимание, что опорные точки можно сохранять отдельно (экспортировать) – для этого есть кнопка **Export Control Points** и импортировать **Import Control Points**.

### Привязка на основе референцного изображения

При привязке снимка к референцному изображению удобно воспользоваться кнопкой **Fit to Display** ![](images/Ref02/Arc_Fit_to_Display.png), которая переместит привязывамаемое изображение в экстент, соответствующий текущему дисплею карты.

Далее для привязки неоходимо снова нажать на кнопку **Add Control Points** и поставить сначала точку на привязываемом изображении, а затем на референцном.

## Географическая привязка в QGIS {#georeference-qgis}
[В начало справки ⇡](#georeference)

Для привязки данных дистанционного зондирования в QGIS можно использовать WMS-сервис с мозаикой спутниковых снимков. Для включения мозаики зайдите в меню **Модули – Управление и установка модулей...**. Впишите в строку поиска __QuickMapServices__. Установите модуль.

Откроется окно модуля. В окне поиска геосервиса введите __Google satelite__ или какой-либо еще картографический веб-сервис со спутниковой подложкой. Нажмите **Добавить**.


![](images/Ref02/QMS.png)


Добавьте в качестве слоя данных привязываемый снимок.

> Примечание: Если у вас такой панели не оказалось, это значит, что она отключена. Для включения панели щелкните правой кнопкой мыши по пустому месту на панели и найдите **панель работы со слоями**.

Включите **Панель инструментов работы с растровыми данными**. На ней нажмите кнопку **Привязка растров** ![](images/Ref02/Reference_button.png).

Откроется окно привязки. Нажмите на кнопку **Открыть растр** ![](images/Ref02/Open_rastr.png), добавьте привязываемый растр. Щелчок левой кнопкой мыши по привязываемому изображению открое окно, куда будет предложено ввести координаты. Если вы для привязки хотите использовать референцное изображение, нажмите на кнопку **С карты**.


![Окно ввода координат](images/Ref02/Input_coordinates.png)


Для настройки параметров трансформации нажмите на кнопку ![](images/Ref02/Transformation_settings.png). Опорные точки можно сохранять и подгружать – для этого используйте соответствующие кнопки на панели. Для запуска процесса трансформации нажмите на кнопку ![](images/Ref02/Transformation_button.png)

После добавления трансформированного изображения в основное окно карты убедитесь в правильности проделанной операции, сравнивая его с подложкой из мозаики спутниковых снимков. Для этого удобно использовать инструмент шторки.

Зайдите в **Модули – Управление и установка модулей...** и вбейте в поиск **MapSwipe Tool**. После этого появится панель шторки.

Выберите слой, который будет активен в режиме шторки (будет находиться под шторкой) и нажмите на кнопку ![](images/Ref02/Swipe_button.png).


![Режим шторки для слоя Google Maps](images/Ref02/Swipe.png)


----
_Карпачевский А.М._ **Основы дистанционного зондирования и фотограмметрии**. М.: Географический факультет МГУ, `r lubridate::year(Sys.Date())`.
----