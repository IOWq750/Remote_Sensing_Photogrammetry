[["index.html", "Основы дистанционного зондирования и фотограмметрии Программное обеспечение QGIS 0.1 Изменение языка интерфейса и прочих глобальных переменных QGIS", " Основы дистанционного зондирования и фотограмметрии Карпачевский А.М. 2023-03-09 Программное обеспечение QGIS Для выполнения работ в учебном курсе вам потребуется скачать и установить на свой компьютер геоинформационное приложение QGIS. Это свободно распространяемое программное обеспечение, то есть для его установки не требуется покупка или регистрация. Windows Скачайте с официального сайта последнюю стабильную версию QGIS. По состоянию на 7 февраля 2023 г. это версия 3.28. Выберите версию в зависимости от разрядности вашей системы. Перейти к скачиванию. Если на вашем компьютере уже установлена более старая версия QGIS, удалите её перед началом установки новой версии. Вы можете использовать старую версию QGIS для выполнения большинства заданий практикума, однако, если у вас возникнут технические проблемы, Когда исполняемый файл загрузится, запустите его. Если потребуется, разрешите приложению вносить изменения на вашем устройстве. Будет показано приветственное окно мастера установки. Нажмите «Далее», чтобы перейти на следующий шаг. На следующем шаге будет показано лицензионное соглашение QGIS и другого программного обеспечения, входящего в пакет поставки. Нажмите «Принимаю». На следующем шаге выберите папку для установки и отметьте, нужно ли создавать ярлыки на рабочем столе и в меню «Пуск». По возможности используйте параметры, предлагаемые по умолчанию. На следующем шаге предлагается запустить процедуру установки. Нажмите «Install». Когда система выдаст запрос на внесение изменений, примите его. После окончания установки ярлыки QGIS будут добавлены в меню «Пуск» и в отдельную папку QGIS на рабочем столе. macOS По состоянию на 2023-03-09 для прохождения практикума рекомендуется использовать альтернативную сборку версии 3.4.12. Перейдя по ссылке, необходимо согласиться сохранить образ установочного диска на компьютер (можно разрешить его сразу открыть средствами DiskImageMounter): После того как образ загрузится и будет открыт, необходимо последовательно запустить три установщика, выделенные на снимке экрана ниже (именно в том порядке, в котором они пронумерованы!): Установщики GDAL Complete и QGIS 3 LTR необходимо запускать через контекстное меню и выбирать пункт «Открыть»: В появившемся диалоговом окне необходимо нажать «Открыть», чтобы разрешить установку: Все опции при установке каждой компоненты приложения оставляйте по умолчанию, ничего не меняйте и нажимайте в диалоговых окнах «Продолжить», пока не запустится установщик. После того как последняя компонента — QGIS — будет установлена, вы сможете найти приложение и запустить его из каталога Программы macOS: Linux Воспользуйтесь инструкциями по этой ссылке. Дополнительную информацию по установке можно найти на https://qgis.org/ru/site/forusers/download.html. 0.1 Изменение языка интерфейса и прочих глобальных переменных QGIS В справке используется англоязычная версия QGIS. Чтобы поменять язык интерфейса в меню основного окна QGIS выберите Установки – Параметры (Settings – Options) В разделе Общие улучшения (General) поставьте галочку возле пункта Переопределить языковые настройки (Override system locale) и выберите напротив пункта Перевод пользовательского интерфейса (User interface translation) язык American English. Нажмите на кнопку OK. Изменения вступят в силу после перезагрузки QGIS. Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["pansharpen.html", "Раздел 1 Преобразования пространственного разрешения 1.1 Создание проекта в ArcGIS Pro 1.2 Создание композита 1.3 Вырезание фрагмента изображения 1.4 Передискретизация 1.5 Фильтрация 1.6 Паншарпенинг", " Раздел 1 Преобразования пространственного разрешения 1.1 Создание проекта в ArcGIS Pro Запустите ArcGIS Pro. В открывшемся окне выберите запуск проекта без шаблона. Окно программы состоит из нескольких основных панелей: слева таблица содержания, самое большое окно посередине – окно карты, справа панель каталог и инструментов геообработки. Панель каталога нужна для того чтобы обращаться к данным, расположенным на компьютере. Раскройте пункт Folders и найдите свою папку, либо папку, расположенную выше по древу. Если её нет, можно добавить подключение к папке, щёлкнув правой кнопкой мыши. Внутри своей папки создайте новую базу геоданных, щёлкнув по ней правой кнопкой. После этого база геоданных появится в перечне всех доступных баз данных в каталоге. Найдите там свою базу и сделайте её базой по умолчанию. Через главное меню добавьте новую карту. Сохраните проект в той же директории, где расположена база данных, после чего в каталоге на этой папке должен появиться значок домика. 1.2 Создание композита Для создания композита перетащите из окна каталога файлы отдельных каналов изображения. В панели геообработки найдите набор инструментов Data Management Tools – Raster – Raster Processing, внутри него выберите инструмент Composite Band. На вход инструменту подайте отдельные каналы, на выход укажите название итогового композита – обратите внимание, что он должен быть в базе геоданных по умолчанию. Для того чтобы задать визуализацию синтеза каналов нового композита, выделите слой и перейдите во вкладку Appearance основной ленты меню. В Band Combination укажите пользовательский синтез (Custom) и задайте соответствие каналов изображения каналам основных цветов. 1.3 Вырезание фрагмента изображения Для вырезания фрагмента изображения необходимо создать новый класс объектов в базе геоданных. Для этого щёлкните правой кнопкой мыши по базе New – Feature Class. В открывшемся окне задайте имя и систему координат класса. Добавьте класс объектов в окно карты и перейдите на вкладку Edit главного меню, выберите пункт Create. Справа откроется панель с шаблонами объектов. Выберите способ создания объекта – прямоугольник. Отрисуйте прямоугольник на карте, который охватит вырезаемую область изображения. После того, как объект будет готов, сохраните изменения, нажав на кнопку . Вырезается фрагмент изображения с помощью инструмента Extract by Mask – его можно найти на панели инструментов геообработки в наборе инструментов Spatial Analyst Tools – Extraction. У полученного фрагмента изображения может быть не настроена гистограмма. Перейдите во вкладку Appearance и нажмите на кнопку DRA для автоматической настройки гистограммы фрагмента, либо исправьте гистограмму вручную. 1.4 Передискретизация Для передискретизации используется инструмент Data Management Tools – Raster – Raster Processing – Resample. В качестве входных параметров необходимо указать исходный растр, а также размер ячейки нового растра и тип интерполяции 1.5 Фильтрация Для градиентной фильтрации выберите растр, в основной ленте меню выберите вкладку Imagery, нажмите на кнопку Raster Functions – у вас справа откроется панель с различными инструментами растров, в том числе во вкладке Appearance есть инструмент свёртки (Convolution). Для линейной (высокочастотная, низкочастотная) фильтрации используется инструмент Spatial Analyst Tools – Neighborhood – Filter. В качестве входных параметров необходимо указать исходный растр, а также тип фильтрации. 1.6 Паншарпенинг Для паншарпенинга используется инструмент Data Management Tools – Raster – Raster Processing – Create Pansharpened Raster Dataset. В качестве входных параметров необходимо указать исходный растр, тип преобразования и некоторые другие параметры, которые зависят от типа преобразования. Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["georeference.html", "Раздел 2 Географическая привязка 2.1 Географическая привязка в ArcGIS Pro 2.2 Географическая привязка в QGIS", " Раздел 2 Географическая привязка 2.1 Географическая привязка в ArcGIS Pro Создайте новый проект и сохраните его. Задайте систему координат датафрейма (карты) – для этого зайдите в свойства Map и перейдите во вкладку Coordinate Systems, раскройте список Projected coordinate system и выберите нужную СК. Свойства системы координат карты Добавьте из панели каталога растр, который необходимо привязать.Выделите его в списке слоев и во вкладке Imagery нажмите на кнопку Georeference. Открытие панели привязки Открытая панель привязки состоит из нескольких кнопок. Убедитесь, что у вас нажата кнопка Auto Apply, которая позволяет трансформировать изображение на лету. Панель привязки Нажмите на кнопку Add Control Points и установите опорную точку в нужном месте на карте. После этого вам будет предложено установить соответственную точку на референцном слое или ввести заданные координаты для точки – для этого щёлкните правой кнопкой мыши, после чего откроется окошко для ввода координат. Окно ввода координат опорной точки Если нажать на кнопку Control Point Table , то откроется таблица, где будут показаны все установленные опорные точки с их координатами в исходной и референцной системе координат. В этой же таблице указываются ошибки (невязки) общая и по отдельным координатам. Слева можно включать и выключать точки из расчёта. Когда точка выключена из расчёта, она превращается из опорной в контрольную. Таблица координат опорных точек Установив необходимое количество точек, вы можете нажать на кнопку Transformation и выбрать тип трансформации. После установки опорных точек и выбора типа трансформации можно запустить процесс трансформирования и сохранения нового изображения, нажав на кнопку . Окно сохранения трансформированного изображения Обратите внимание, что опорные точки можно сохранять отдельно (экспортировать) – для этого есть кнопка Export Control Points и импортировать Import Control Points. 2.2 Географическая привязка в QGIS В начало справки ⇡ Для привязки данных дистанционного зондирования в QGIS можно использовать WMS-сервис с мозаикой спутниковых снимков. Для включения мозаики зайдите в меню Модули – Управление и установка модулей…. Впишите в строку поиска QuickMapServices. Установите модуль. Откроется окно модуля. В окне поиска геосервиса введите Google satelite или какой-либо еще картографический веб-сервис со спутниковой подложкой. Нажмите Добавить. Добавьте в качестве слоя данных привязываемый снимок. Примечание: Если у вас такой панели не оказалось, это значит, что она отключена. Для включения панели щелкните правой кнопкой мыши по пустому месту на панели и найдите панель работы со слоями. Включите Панель инструментов работы с растровыми данными. На ней нажмите кнопку Привязка растров . Откроется окно привязки. Нажмите на кнопку Открыть растр , добавьте привязываемый растр. Щелчок левой кнопкой мыши по привязываемому изображению открое окно, куда будет предложено ввести координаты. Если вы для привязки хотите использовать референцное изображение, нажмите на кнопку С карты. Окно ввода координат Для настройки параметров трансформации нажмите на кнопку . Опорные точки можно сохранять и подгружать – для этого используйте соответствующие кнопки на панели. Для запуска процесса трансформации нажмите на кнопку После добавления трансформированного изображения в основное окно карты убедитесь в правильности проделанной операции, сравнивая его с подложкой из мозаики спутниковых снимков. Для этого удобно использовать инструмент шторки. Зайдите в Модули – Управление и установка модулей… и вбейте в поиск MapSwipe Tool. После этого появится панель шторки. Выберите слой, который будет активен в режиме шторки (будет находиться под шторкой) и нажмите на кнопку . Режим шторки для слоя Google Maps Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["mosaic.html", "Раздел 3 Создание мозаики 3.1 Создание мозаики в ArcGIS Pro", " Раздел 3 Создание мозаики 3.1 Создание мозаики в ArcGIS Pro В начало справки ⇡ Для создания мозаики с помощью ГИС-пакета ArcGIS Pro необходимо создать специальный набор данных мозаики внутри базы данных. Следует понимать, что этот набор данных не хранит собственно растры, а лишь ссылки на них. Для его создания нажмите правой кнопкой мыши по базе данных, выберите пункт New – Mosaic Dataset. В открывшемся окне геообработки укажите параметры мозаики – название набора и проекцию. Нажмите на кнопку Run. В результате в таблицу содержания добавится специальный слой мозаики, который включает в себя собственно изображения, границы мозаики и границы отдельных изображений. Пока в мозаику не добавлены снимки, эти слои останутся пустыми. Для добавления растров в мозаику правой кнопкой мыши кликните по набору и выберите . Откроется окно инструмента. Если растры находятся в одной папке, можно указать её в качестве источника данных, либо можно указать каждый растр индивидуально, выбрав категорию Dataset в окне Input Data. В разделе Raster Processing рекомендуется включить расчёт статистики и построение пирамид. Примечание: Обратите вимание, что в окне Raster Type можно выбрать соответствующую категорию из доступных съёмочных систем, а в Processing Templates можно выбрать тип продукта (уровень обработки). Для настройки комбинации каналов мозаики выберите слой с изображением, выберите сверху вкладку Appearance, нажмите на Band Combination. Вы можете изменить яркость и контрастность изображения через настройку гистограммы Stretch Type. После добавления снимков в мозаику необходимо задать для них линию реза (seamline) – границу стыковки соседних снимков. Для их создания необходимо правой кнопкой мыши щёлкнуть по мозаике в каталоге и выбрать пункт Enhance – Generate Seamlines…, после чего откроется окно соответствующего инструмента. Обратите внимание, что линия реза может быть рассчитана разными методами. GEOMETRY — На основе отпечатков (границ) изображений. RADIOMETRY — На основе спектральных особенностей изображений. EDGE_DETECTION — На основе обнаружения границ между паттернами. VORONOI — На основе диаграммы Вороного. DISPARITY — На основе диспаратных изображений стереопары. В результате в таблице содержания в мозаике появится соответствующий векторный слой. Для показа снимков мозаики в соответствии с линиями реза нужно перейти во вкладку Data на основной панели и выбрать Sort – Seamline. Для коррекции цветового баланса снимков, входящих в мозаику, нужно в каталоге правой кнопкой мыши по мозаике вызвать Enhance – Color Balance…. Для сохранения мозаики в виде отдельного изображения щёлкните правой кнопкой по мозаике в таблице содержания – Data – Export Raster Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["photogrammetry.html", "Раздел 4 Фотограмметрия кадрового снимка 4.1 Искажения наклонного снимка 4.2 Внутреннее ориентирование снимка", " Раздел 4 Фотограмметрия кадрового снимка 4.1 Искажения наклонного снимка В начало справки ⇡ 4.2 Внутреннее ориентирование снимка В начало справки ⇡ Параметры внутреннего ориентирования снимка определяют систему координат снимка с началом в центре его проекции. Параметры внутреннего ориентирования \\(a_{0}, a_{1}, a_{2}, b_{0}, b_{1}, b_{2}\\) – параметры аффинного преобразования системы координат на основе измерений координатных меток. Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["stereo.html", "Раздел 5 Стереоизмерения 5.1 Установка программного обеспечения 5.2 Исходные данные 5.3 Создание проекта 5.4 Внутреннее ориентирование 5.5 Опорные точки 5.6 Обратная фотограмметрическая засечка 5.7 Взаимное ориентирование снимков 5.8 Работа в стереокомпараторе", " Раздел 5 Стереоизмерения 5.1 Установка программного обеспечения В начало справки ⇡ Для практической работы вам понадобится открытая учебная фотограмметрическая программа E-foto. Информацию о ней можно найти на домашнем сайте, там же можно скачать себе дистрибутив программы. Для этого перейдите во вкладку DOWNLOAD – Latest Version. Страница для загрузки программы и данных Запустите скачанный пакет установщика и установите программу. 5.2 Исходные данные В начало справки ⇡ В качестве исходных данных мы будем использовать серию аэрофотоснимков с перекрытием на территорию окрестностей УНС Сатино, сделанную в 1970 году, а также сеть опорных точек и топографическую карту. Снимки Наземные опорные точки Топографическая карта масштаба 1:10 000 5.3 Создание проекта В начало справки ⇡ Запустите программу E-foto. В меню выберите Project – New. Укажите путь для сохранения файла проекта с расширением .epp. Откроется окно менеджера проекта. Слева приведена структура проекта, а по центру - содержание. В разделе Project Header вам нужно указать общую информацию о проекте. Для этого включите режим редактирования, нажав на кнопку Edit внизу страницы. Окно менеджера проекта Перейдите в раздел Terrain и укажите общую информацию о территории. Максимальная высота – 200 м. Минимальная высота – 133 м. Средняя высота – 167 м. Зона UTM – 37. Примерную широту и долготу центра территории укажите, используя программу Google Earth и точки фототриангуляции. Не забудьте указать правильные полушария. Перейдите в раздел Sensor и укажите общую информацию о съёмке. Сенсор – АФА-41/10. Тип – кадровый аналоговый снимок. Калиброванное фокусное расстояние аэрофотоаппарата – 96.78 мм. Координаты главной точки – x = 0.5, y = 0.4. Компенсированная радиальная дисторсия учтена при калибровке фокусного расстояния (исходно 100 мм). Некомпенсированная радиальная дисторсия +-25 мкм, что очень мало, поэтому мы ей можем пренебречь. Укажите координаты координатных меток снимков (Fiducial marks) в последней таблице. Координаты меток В разделе Flight мы можем указать примерную высоту съёмку – 1500 м, а также примерный масштаб снимков 1:14 000. В разделе images нужно загрузить аэрофотоснимки, указав их разрешение – 600 dpi. Вы можете после этого открыть раздел с каждым из загруженных снимков и увидеть информацию о нём. Параметры снимка внутри проекта В этом разделе нажмите на кнопку View Image для просмотра изображения. Если при открытии изображения возникла ошибка, то, скорее всего, у вас неправильно записались пути в файле проекта. Обратите внимание на снимок экрана выше – в строке пути должен быть указан путь, в строке имени файла - только его имя, а в строке ID снимка достаточно указать имя файла без расширения. Исправить это внутри программы нельзя, но, к счастью, файл проекта – это документ XML, который редактируется блокнотом. Найдите внутри него соответствующие теги и исправьте содержимое внутри них. Параметры снимка в формате XML 5.4 Внутреннее ориентирование В начало справки ⇡ Для выполнения внутреннего ориентирования снимков выберите пункт меню Execute – Interior Orientation. В открывшемся окне предлагается выбрать снимок для ориентирования. Необходимо последовательно выполнить эту операцию для всех снимков. Для масштабирования можно использовать инструмент лупы, который работает на выделяемую прямоугольную область. Для произвольного изменения масштаба в обе стороны нужно зажать колёсико мыши. Координатные метки рассматриваемых снимков расположены возле края середины каждой из сторон и представляют собой асимметричные кресты, которые по размеру больше, чем обычные регулярные кресты, идущие с шагом в 1 см. Координатная метка снимка Обратите внимание на порядок координатных меток – правая, левая, верхняя, нижняя. Вам нужно расставлять их в таком же порядке. Внизу окна приводится табличка, где выделена строка с активной на данной момент меткой. Как только вы метку установили, автоматически активной становится следующая метка в таблице. Если вам необходимо исправить положение координатной метки, то нужно выделить соответствующую строку в таблице и указать на снимке правильное положение метки. После расстановки меток нажмите на кнопку . В результате откроется окно отчёта внутреннего ориентирования с вектором параметров аффинного преобразования системы координат камеры и матрицей вариации-ковариации. Если точность операции удовлетворительная, то будет активна кнопка Accept, нажав которую, мы сохраняем параметры. После этого нажмите на кнопку Done , что вернёт вас в основное окно проекта. Отчёт внутреннего ориентирования Аналогично операция проделывается для всех снимков. 5.5 Опорные точки В начало справки ⇡ Поскольку параметры внешнего ориентирования нам заранее неизвестны, то их необходимо рассчитать на основе обратной фотограмметрической засечки. Для этого нам потребуются опорные точки с известными координатами и высотами. Откройте в программе Google Earth Pro файл KML с точками фототриангуляции. Для просмотра нам потребуется снимок QuickBird за 20 апреля 2006 года (как самый хронологически близкий к 1970), который можно включить кнопкой . Опорные точки на снимке QuickBird за 20 апреля 2006 года Следует иметь в виду, что координаты этих точек достаточно точно уравнены между собой, но снимок сам по себе может быть аффинно сдвинут на некую постоянную величину. Нам необходимо получить координаты этих точек в проекции UTM. Для переключения показа координат в UTM зайдите в меню Инструменты – Настройки и выберите соответствующий пункт в разделе Показывать шир/долг. Настройки показа координат Теперь, если вы правой кнопкой мыши щёлкните по опорной точке и из меню выберите Свойства, перед вами откроется окно с координатами восточного и северного склонения для точки. Для добавления опорных точек в программе E-foto в меню проекта перейдите в раздел Points и нажмите на кнопку New. В открывшемся окне задайте имя опорной точки, впишите её координаты из Google Earth. Высоту точки возьмите с топографической карты, зная, что сечение основных горизонталей 2 метра. Для плановых координат указывается стандартное отклонение 3 метра (это худшее возможное значение согласно некоторым исследованиям [1, 2]). Для высот укажите СКО в 2 метра. Опорная точка Описание точки на АФС p1 Северо-восточный угол сельского клуба в Сатино p2 Северо-западный угол сатинскогохрамамагазина p3 Северо-западный угол пруда в Ивановском p4 Угол леса в районе Бутовского холма p10 Северо-восточный угол забора садов в Рыжково p11 Юго-восточный угол пристройки коровника в Загрязье p12 Юго-западный угол коровника в Ивановском p13 Внутренний угол забора садового участка в Сатино p14 Юго-восточный угол залежной полосы на склоне южнее урочища Вторые Столбцы p15 Северный угол островка леса на Дедюевском холма, соответствующий краю развилки дорог p16 Одиноко стоящее дерево в верховьях Антоновской балки p17 Юго-восточный угол пруда в Медвежьем болоте p18 Западный угол пожарного пруда в Рыжковской излучине p19 Поворот дороги вдоль юго-восточного угла леса p20 Северо-западный угол храма в Беницах p21 Угол забора в Рыжково p22 Верхушка оврага Узкого p23 Барсучий овраг Внесите информацию об опорных точках и сохраните проект. 5.6 Обратная фотограмметрическая засечка В начало справки ⇡ Для внешнего ориентирования с помощью обратной фотограмметрической засечки в меню выберите пункт Execute – Spatial Resection. Аналогично внутреннему ориентированию откроется окно с выбором снимка. Далее откроется снимок с таблицей опорных точек внизу. Аналогично расстановке координатных меток установите опорные точки на снимке с помощью кнопки Measure . Пропускайте те точки, которые отсутствуют на данном снимке. Для исключения опорной точки из засечки нажмите на крестик . После расстановки всех опорных точек на снимке нажмите на , согласитесь со всеми параметрами точности, после чего перед вами откроется отчёт об уравнивании с параметрами внешнего ориентирования и матрицей вариации-ковариации. Окно отчёта уравнивания параметров внешнего ориентирования Обратите внимание, что значение координаты Z должно быть около 1600 м, значения углов должны быть маленькими. Если параметры точности в матрице достаточны, то вы сможете нажать на кнопку Accept – параметры внешнего ориентирования будут сохранены. После этого нажмите на кнопку Done , что вернёт вас в основное окно проекта. Проделайте аналогичные операции для остальных снимков. 5.7 Взаимное ориентирование снимков В начало справки ⇡ Ранее вы получили элементы внешнего ориентирования для каждого снимка по отдельности. Для более точного ориентирования модели местности необходимо взаимно ориентировать снимки и сделать уравнивание связок. В меню выберите пункт Execute – Phototriangulation. Окно стереокомпаратора Перед вами откроются окна с левым и правым снимком, окно со списком наземных опорных точек, а также окна с их измерениями на соответственных снимках. Для фототриангуляции необходимо дополнительно поставить так называемые фотограмметрические точки (связующие точки). Обратите внимание, что для корректных измерений и дальнейшего ориентирования модели необходимо правильно указать левый и правый снимок – они должны быть в соответствующих окнах. Для создания связующей точки нажмите на кнопку Create a photogrammetric point in project . Затем разместите точку с помощью кнопки Measure на левом и правом снимке. При выборе места размещения помните о наилучших местах на стереопаре при взаимном ориентировании снимков. После расстановки всех связующих точек нажмите на кнопку Execute phototriangulation . Откроется окно, где будут предложены снимки и точки для уравнивания связок проектирующих лучей. Окно выбора снимков и точек для фототриангуляции Если на предыдущих этапах всё было сделано правильно, то вы получите отчёт с корректными значениями элементов внешнего ориентирования, которые можно принять и использовать в дальнейшем. Помимо элементов внешнего ориентирования в отчёте приводятся поправки к ним относительно ранее выполненной обратной фотограмметрической засечки, а также расчётные координаты для связующих точек. Окно отчёта фототриангуляции Обратите внимание, что из-за особенностей программы координата северного склонения в отчёте получает дополнительный разряд в начале. К сожалению, в текущей версии эта проблема не решается и для дальнейшей работы необходимо иметь в виду, что у вас есть дополнительный сдвиг по оси Y на 10000000 м. Если полученные результаты вас устраивают, нажмите на кнопку Save measurements. 5.8 Работа в стереокомпараторе В начало справки ⇡ В меню проекта выберите пункт Execute – Stereo Plotter. Откроется окно с анаглифными изображением стереопары снимков. Для эффективной работы с анаглифами рекомендуется использовать специальные очки. Окно стереокомпаратора Если изображение в анаглифических очках двоится, зажмите SHIFT и подвиньте изображение до тех пор, пока рассматриваемый участок не сольётся в объёмное изображение. Для измерения высоты в точке нужно добавить точку с помощью кнопки , далее выбрать кнопку . При устранённых параллаксах (восстановленной стереомодели на данную территорию) с помощью колеса мыши нужно посадить марку на измеряемый объект. На увеличенных фрагментах левого и правого изображения снизу будут показываться эти марки в «монокулярном» режиме. Как только мнимая марка слилась (реальные марки оказались на соответственных точках), нажмите левую кнопку мыши и в окне справа появятся измерения для данной точки. В случае, если вы замечаете поперечный параллакс, необходимо зажать CTRL и крутить колесо мыши до тех пор, пока поперечный параллакс не станет равен нулю. Результаты измерений можно экспортировать в виде текстового файла, нажав на кнопку . Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["dem.html", "Раздел 6 Получение ЦММ и ортотрансформация 6.1 Исходные данные 6.2 Построение ЦММ 6.3 Работа с высотными данными в QGIS 6.4 Построение производных поверхностей 6.5 Верификация ЦММ по точкам стереоизмерений 6.6 Ортотрансформация с использованием полученной ЦММ", " Раздел 6 Получение ЦММ и ортотрансформация 6.1 Исходные данные В начало справки ⇡ В качестве исходных данных в этой работе выступают ориентированные и привязанные снимки из предыдущей модели, а также полученная на их основе стереомодель в программе E-foto. 6.2 Построение ЦММ В начало справки ⇡ Выберите команду Execute – DSM Extraction. Откроется окно соответствующего модуля.Перейдите во вкладку Automatic Extraction. Настройки извлечения ЦММ Здесь можно выбрать тип радиометрической коррекции – для чёрно-белых снимков лучше всего выбрать Histogram matching. Для обработки стереопар и поиска тождественных точек в программе доступно два метода – кросс-корреляции (Cross-correlation) и наименьших квадратов (Least-Squares Matching). Проделайте сначала всё одним методом, затем попробуйте другой и сравните результат. Для ускорения процесса построения лучше задать параметр передискретизации (Image downsampling) 2 (размер пикселов уменьшиться в два раза). В окне Use pairs выберите ту стереопару, по которой нужно построить ЦММ. Нажмите на кнопку для запуска процесса. По окончании процесса откроется окно для просмотра найденных пикетов в виде жёлтых крестиков. После того, как пикеты были извлечены, необходимо их интерполировать. Для этого нажмите на соответствующую кнопку . После этого можно экспортировать полученный грид.Перейдите во вкладку Load/Save Options, выберите DSM extraction file format – облако точек без индексов, а Grid file format – ASCII DSM Grid. В разделе DSM Grid Interpolation внизу окна нажмите на сохранение и сохраните текстовый файл с высотными данными. 6.3 Работа с высотными данными в QGIS В начало справки ⇡ Добавьте в QGIS полученные ранее высотные данные как текст с разделителями. Обратите внимание, что необходимо правильно выбрать символ разделителя, указать количество строк заголовка файла, которые мы не учитываем, указать соответствующие поля для координат, а также правильную систему координат. Добавление ASCII-файла как текста с разделителями Добавленные данные необходимо сохранить либо в виде шейп-файла, либо в базе геоданных, щёлкнув правой кнопкой по слою Экспорт – сохранить как. Для получения растровой поверхности используйте инструмент Grid (Nearest Neighbor)…. Его можно найти через меню Raster – Analysis. Укажите поле для Z-значений в настройках инструмента. После настройки символики ваша ЦММ примет примерно следующий вид – очевидно, что в ней много пропущенных данных. Визуализация первичной ЦММ с пропусками данных Для заполнения пропусков воспользуйтесь инструментом Raster – Analysis – Fill nodata…. После этого ЦММ должна принять примерно следующий вид: Визуализация ЦММ с заполненными пропусками 6.4 Построение производных поверхностей В начало справки ⇡ В QGIS доступны многие инструменты для построения производных поверхностей от ЦМР и ЦММ, например: Углы наклона – Raster – Analysis – Slope…. Экспозиция склонов – Raster – Analysis – Aspect…. Аналитическая отмывка рельефа – Raster – Analysis – Hillshade…. Кроме того, мы можем извлечь изолинии (горизонтали) с помощью инструмента Raster – Extraction – Contour…. 6.5 Верификация ЦММ по точкам стереоизмерений В начало справки ⇡ Измерьте высоты с помощью стереокомпаратора в местах, где есть крупные пропуски данных в ЦММ. Полученные точки можно экспортировать в шейпфайл, нажав на кнопку . В открывшемся окне выберите формат сохранения SHP. Для извлечения значений высот ЦММ в точки используйте инструмент в QGIS Sample Raster Values. Этот инструмент записывает в виде атрибута значения ячеек растра, в которые попадают точки. Для расчёта собственных значений высот точек шейпфайла (полученные в результате стереоизмерений) можно зайти в калькулятор поле и написать выражение для нового атрибутивного поля _ z($geometry)_. 6.6 Ортотрансформация с использованием полученной ЦММ В начало справки ⇡ Для ортотрансформации снимков в E-foto требуется ЦММ в собственном формате, что обуславливает необходимость её коррекции (заполнения пропусков) внутренними средствами программы. Для этого в модуле DSM Extraction после извлечения ЦММ перейдите на вкладку Interpolation. В параметре Grid Interpolation method необходимо выбрать Moving average (обычно установлено по умолчанию). В параметре Distance укажите размер плавающего окна осреднения в пикселях, например, 10. настройки интерполяции Сохраните ЦММ в формате ASCII DSM Grid и выйдите из модуля. Запустите модуль ортотрансформации Execute – Ortho-Rectification. Окно модуля ортотрансформации Выберите изображение, которое необходимо ортотрансформировать, укажите формат ЦММ такой же, как вы указывали для её сохранения, укажите путь к файлу ЦММ. В качестве выходного формата для изображения укажите GeoTIFF. Для запуска процедуры нажмите . Ортотрансформированное изображение скорее всего сохранится без СК, но вы сможете её задать в QGIS. для сопоставления ортотрансформированного изображения с исходным можно воспользоваться инструментом Шторка. Сопоставление ортотрансформированного изображения с исходным Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["photomod.html", "Раздел 7 Обработка данных аэрофотосъёмки в ЦФС PHOTOMOD 7.1 Программное обеспечение 7.2 Исходные данные 7.3 Создание проекта 7.4 Внутреннее ориентирование 7.5 Измерение сети 7.6 Уравнивание сети 7.7 Работа в стереорежиме", " Раздел 7 Обработка данных аэрофотосъёмки в ЦФС PHOTOMOD 7.1 Программное обеспечение В начало справки ⇡ Для практической работы вам понадобится цифровая фотограмметрическая система PHOTOMOD. Информацию о ней можно найти на домашнем сайте (https://racurs.ru/), там же можно скачать себе дистрибутив бесплатной версии программы, предварительно зарегистрировавшись. 7.2 Исходные данные В начало справки ⇡ В качестве исходных данных мы будем использовать серию аналоговых аэрофотоснимков на территорию WaldKirch (Германия). Снимки Параметры камеры Наземные опорные точки 7.3 Создание проекта В начало справки ⇡ Запустите программу PHOTOMOD 7 X64. Если вы используете Lite версию, то откроется окно с информацией об усеченном функционале. Интерфейс программы представляет собой набор окон, например, окно главного меню, окно схемы блока, а также различные панели работы с данными. При запуске программы открывается окно управления проектами. Для создания проекта нажмите на соответствующую кнопку справа. Окно менеджера проекта Справа выберите путь для создания проекта. Обратите внимание, что по умолчанию предлагаются системные пути на диске C. вы можете создать новый путь, нажав на кнопку Open Explorer , а затем на кнопку подключения . Обратите внимание, что у программы есть свои особенности, связанные с сетевой структурой хранения данных, что может не позволить вам создать проект с произвольным путём не на диске C. Заполните Имя проекта, Описание. Если вы работаете с фотографическими снимками, выберите в Тип Центральная проекция. Укажите правую декартовую систему координат – для этого нажмите на Выбрать – Из БД – Международная, в открывшемся окне найдите Cartesian Right (№142). Задайте амплитуду высот местности от 400 до 900 м. нажмите ОК для создания проекта. 7.4 Внутреннее ориентирование В начало справки ⇡ Перед вами откроется окно создания нового маршрута – можно согласиться с именем по умолчанию. Маршрут – это совокупность снимков, полученных с одного галса залёта. Затем вы перейдёте к окну редактора блока снимков. Блок снимков – это совокупность всех снимков, сделанных на изучамую территорию в течение залёта. Окно менеджера проекта Кнопки и предназначены для добавления снимков. Первая позволяет добавить файлы из любого места, а вторая – из подключенных папок, включая папку проекта. Проще использовать вторую кнопку – для этого необходимо переместить данные в папку Images проекта (C:/PHOTOMOD6.VAR/Profiles/%Имя профиля%/%Имя проекта%/Images). По умолчанию программа формирует накидной монтаж из снимков, состоящий из одного маршрута (в одну линию). Накидной монтаж – схематическое наложение снимков блока, исходя из их принадлежности к маршрутам, порядка съёмки, значений продольного и поперечного перекрытия. Используемые снимки в именах файлов содержат информацию о принадлежности к маршрутам (число до символа ‘_’) и порядковом номере снимка (число после символа ‘_’). Можно заметить, что используемые снимки относятся к маршрутам 2 и 3. В основном окне программы найдите меню Блок – Разбить на маршруты – По именам снимков. Разбивка по маршрутам Поскольку маршрут 2 представляет собой галс обратного направления съёмки, необходимо его выделить в редакторе блока и нажать на кнопку изменения порядка изображений в маршруте . Правильный порядок кадров в маршрутах блока Откройте окно накидного монтажа в главном меню Окна – Накидной монтаж или нажав на кнопку в окне редактора блока. Задайте продольное и поперечное перекрытие в 65 и 43%, для предварительного внешнего ориентирования снимков выберите Центры проекции и углы. Нажмите на кнопку Применить и закройте окно, после чего накидной монтаж перестроится. Настройки накидного монтажа Далее необходимо задать параметры камеры, с помощью которой были сделаны кадры. Для этого в главном меню программы выберите пункт Ориентирование – Управление камерами. В открывшемся окне необходимо создать камеру, нажав на кнопку . Параметры камеры можно заполнить самостоятельно, а можно импортировать из файла, предоставленного в исходных данных. Камера: RC_30 Тип камеры: аналоговая Единицы измерения: мм Фокусное расстояние: 153.5030 Координаты главной точки: X: 0.0020, Y: 0.0110 Дисторсия: Формула (физ.) Информация о метках: Координаты меток Настройки накидного монтажа После этого необходимо выделить все снимки в окне управления камерами проекта и убедиться в том, что стоит галка напротив опции Присвоить выбранную камеру выбранным изображениям. Нажмите на кнопку Выполнить. После закрытия окна камера присвоится ко всем снимкам. В окне редактора блока выделите снимок 2_0710, после чего в главном меню программы выберите Ориентирование – Внутреннее ориентирование – Внутреннее ориентирование снимка. Откроется окно для задания координатных меток снимков. Для ориентирования необходимо выбрать каждую строку координат из таблицы внизу и указать их положение на соответственных координатных метках. После установки маркера необходимо нажать на кнопку Измерить метку. Окно внутреннего ориентирования снимка Для того чтобы перемещать снимок, используйте зажатую клавишу ALT. Изменение масштаба осуществляется с помощью соответствующих кнопок над изображением. После расстановки координатных меток снимка нажмите кнопку Применить и OK. Координатные метки на всех остальных снимках можно расставить автоматически. Выберите в главном меню Ориентирование – Внутреннее ориентирование – Полуавтоматическое внутреннее ориентирование. Выберите все изображения в окне, поставив напротив них галочки. Введите параметры размера области метки 101 и размер области поиска 201. Коэффициент корреляции 0,9. Аффинный тип преобразования. Нажмите выполнить. Появится сообщение о том, что найдены все метки на 5 изображениях. Нажмите ОК. Закройте окно полуавтоматического внутреннего ориентирования. Полуавтоматическое внутреннее ориентирование снимка В окне управления камерами проекта вы можете увидеть знак + напротив каждого снимка в колонке внутреннего ориентирования. Можно ознакомиться с отчётом по внутреннему ориентированию. Выберите пункт главного меню Ориентирование – Внутреннее ориентирование – Отчет по внутреннему ориентированию, либо нажмите на кнопку в окне управления камерами. Необходимо убедиться, что ошибка по СКО у измеренных меток не больше 0,5 пиксела. При несоответствии ваших измерений этому допуску ошибка подсветится красным цветом. Отредактировать измерение можно, нажав на синюю звездочку в левом столбце таблицы отчета напротив измерения, превышающего допуск. После исправления возможных ошибок закройте окно отчета и окно управления камерами проекта. 7.5 Измерение сети В начало справки ⇡ Выберите пункт главного меню Ориентирование – Автоматическое измерение связующих точек – Аэросъёмка (Площадной коррелятор). Откроется окно, убедитесь, что параметры соответствуют тому, что указано на скриншоте. Нажмите Выполнить, по завершении операции нажмите ОК и закройте открывшийся отчёт. Окно автоматического измерения связующих точек Для перестройки накидного монтажа выберите пункт меню Проект – Синхронизировать В окне накидного монтажа или редактора блока выберите любой снимок. Далее импортируйте опорные точки в проект, выбрав пункт главного меню Ориентирование – Каталог опорных точек. В открывшемся окне нажмите на кнопку импорта и выберите файл Waldkirch_GCP.csv. В открывшемся окне убедитесь, что выбран правильный разделитель колонок, а также указана правильный порядковый номер строки, с которой начинает чтение файла. Колонки с данными должны соответствовать колонкам в окне. Окно импорта опорных точек Далее необходимо последовательно выбрать добавленные опорные точки в таблице и каждую измерить, нажав на кнопку Найти/измерить точку . После нажатия откроется окно со снимком. С помощью инструментов на верхней панели вы можете менять масштаб, а также премещаться между снимками накидного монтажа. Помните о том, что опорные точки, как правило, имеют свои проекции на нескольких снимках, но на данном этапе необходимо поставить точку только на одном снимке из блока. Окно измерения опорных точек Изучите размещение опорных точек по рисунке ниже и найдите каждую. После нахождения точки и установки маркера в центр опознака необходимо нажать на кнопку Переместить точку в положение маркера . Размещение опорных точек на снимке 0722 Размещение опорных точек на снимке 0712 Далее приведены положения всех опорных точек в крупном масштабе. Обратите внимание, что каждая точка представляет собой опознак белого цвета с двумя перпендикулярными прямоугольниками. Схематичное изображение опознака Точка 40169P Точка 6719 Точка 6720 Точка 779 Точка 970 Точка 163 После измерения всех опорных точек на одном снимке нажмите кнопку Применить. Для измерения остальных проекций точек на других снимках дважды щёлкните по точке в таблице. Откроются другие снимки, на которых эта точка должна присутствовать. Снимок, на котором точка была измерена в первый раз, назначьте левым, нажав на кнопку . Поставьте маркер на правом снимке (снимках) в нужное место и нажмите на кнопку Коррелировать все с левым . При правильной установке проекции опорной точки будет получен высокий коэффициент корреляции. Если вы заметили, что коррелятор некорректно ставит проекцию точки, то поставьте её вручную с помощью кнопки Переместить точку в положение маркера. По завершении работы со всеми точками нажмите Применить и ОК. 7.6 Уравнивание сети В начало справки ⇡ Запустите уравнивание блока в главном меню Ориентирование – Уравнивание блока. На открывшейся панели нажмите на кнопку Редактировать параметры уравнивания и вид отчёта . Для начального приближения выберите метод по схеме блока, а уравнивания по методу связок. Окно параметрова уравнивания и вида отчета Зайдите в настройки уравнивания методом связок и убедитесь, что веса для параметров уравнений равны 1. Это значение можно менять, но при это общая точность может ухудшиться. Точность измерений на снимках установите в 0,5 пикселя, поскольку это оптимальное значение параметра по соотношению время работы алгоритма/точность. Параметры метода связок Нажмите на кнопку Уравнять, если не требуется менять параметры системы координат и вида отчета. 7.7 Работа в стереорежиме В начало справки ⇡ Включите стереорежим в программе – для этого в главном меню выберите Сервис – Параметры – Стерео – Анаглифический, если вы планируете работать с анаглифическими очками. Также в главном меню выберите Окна – Новое 2D-окно (стереопара), либо нажмите на главной панели кнопку . Нажмите на кнопку перехода в стереорежим . При необходимости для инвертирования стереоэффекта нажмите на кнопку . Для перемещения по стереопаре используйте лапку. Для изменения масштаба – соответствующие инструменты на панели. Внутри стереорежима можно вызвать окно измерительной марки (маркера) Окна – Окно маркера. Нажатие левой клавиши мыши позволяет узнать координаты точки на стереопаре. Плавное передвижение маркера с пиксельной точностью осуществляется стрелками на клавиатуре. Для сведения марки используйте колёсико мыши или клавиши page up, page down. Маркер в стереорежиме Изменение продольного параллакса осуществляется зажатой клавишей shift и колесом мыши, либо вы можете нажать на кнопку Подстроить глубину в соответствии с текущим положением маркера или нажатием на клавишу f2. Подгонять значение продольного параллакса можно и автоматически нажатием на клавишу пробел, но коррелятор не всегда срабатывает, и тогда вы услышите звуковой сигнал. Настройки коррелятора можно поменять, вызвав Сервис – Параметры – Коррелятор. Вы можете поменять форму, размер и цвет самого маркера в Сервис – Параметры – Маркер (стереопара). Для перехода между стереопарами есть специальная панель, которую можно открыть, вызвав Окна – Панели инструментов – Смена стереопары. Панель смены стереопары Карпачевский А.М. Основы дистанционного зондирования и фотограмметрии. М.: Географический факультет МГУ, 2023. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
