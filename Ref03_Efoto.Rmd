# Стереоизмерения {#stereo}

## Установка программного обеспечения {#stereo-soft}
[В начало справки ⇡](#stereo)


Для практической работы вам понадобится открытая учебная фотограмметрическая программа **E-foto**. Информацию о ней можно найти на домашнем сайте (http://www.efoto.eng.uerj.br/), там же можно скачать себе дистрибутив программы. Для этого перейдите во вкладку **DOWNLOAD – Latest Version**


![Страница для загрузки программы и данных](images\Ref03\Download.png)


Запустите скачанный пакет установщика и установите программу.

## Исходные данные {#stereo-initial}
[В начало справки ⇡](#stereo)

В качестве исходных данных мы будем использовать серию аэрофотоснимков с перекрытием на территорию окрестностей УНС Сатино, сделанную в 1970 году, а также сеть опорных точек и топографическую карту.

[Снимки](https://yadi.sk/d/x7V_hMkPuviJVw){target="_blank"}

[Наземные опорные точки](https://yadi.sk/d/gEQC2jcCFJGifA){target="_blank"}

[Топографическая карта масштаба 1:10 000](https://yadi.sk/i/XM7Z30SZcvy6IA){target="_blank"}

## Создание проекта {#stereo-create_project}
[В начало справки ⇡](#stereo)

Запустите программу **E-foto**. В меню выберите **Project – New**. Укажите путь для сохранения файла проекта с расширением **.epp**.

Откроется окно менеджера проекта. Слева приведена структура проекта, а по центру - содержание. В разделе **Project Header** вам нужно указать общую информацию о проекте. Для этого включите режим редактирования, нажав на кнопку **Edit** внизу страницы.


![Окно менеджера проекта](images\Ref03\Project_Manager.png)


Перейдите в раздел **Terrain** и укажите общую информацию о территории.

_Максимальная высота_ – 200 м

_Минимальная высота_ – 133 м

_Средняя высота_ – 167 м

_Зона UTM_ – 37

Примерную широту и долготу центра территории укажите, используя программу **Google Earth** и точки фототриангуляции. Не забудьте указать правильные полушария.

Перейдите в раздел **Sensor** и укажите общую информацию о съёмке.

_Калиброванное фокусное расстояние аэрофотоаппарата_ – 96.78 мм.

_Координаты главной точки_ – x = 0.5, y = 0.4.

Информации о параметрах дисторсии камеры у нас нет.

Укажите координаты координатных меток снимков (**Fiducial marks**) в последней таблице.

![Координаты меток](images\Ref03\Fiducial.png)


В разделе **Flight** мы можем указать примерную высоту съёмку – 1500 м, а также примерный масштаб снимков 1:14 000.

В разделе **images** нужно загрузить аэрофотоснимки, указав их разрешение – **600 dpi**. Вы можете после этого открыть раздел с каждым из загруженных снимков и увидеть информацию о нём.

![Параметры снимка](images\Ref03\Image.png)


В этом разделе нажмите на кнопку **View Image** для просмотра изображения. Если при открытии изображения возникла ошибка, то, скорее всего, у вас неправильно записались пути в файле проекта. Обратите внимание на снимок экрана выше – в строке пути должен быть указан путь, в строке имени файла - только его имя, а в строке ID снимка достаточно указать имя файла без расширения. Исправить это внутри программы нельзя, но, к счастью, файл проекта – это документ XML, который редактируется блокнотом. Найдите внутри него соответствующие теги и исправьте содержимое внутри них.


![Параметры снимка](images\Ref03\XML_editing.png)


## Внутреннее ориентирование {#stereo-interior}
[В начало справки ⇡](#stereo)

Для выполнения внутреннего ориентирования снимков выберите пункт меню **Execute – Interior Orientation**. В открывшемся окне предлагается выбрать снимок для ориентирования. Необходимо последовательно выполнить эту операцию для всех снимков. Для масштабирования можно использовать инструмент лупы, который работает на выделяемую прямоугольную область. Для произвольного изменения масштаба в обе стороны нужно зажать колёсико мыши. Координатные метки рассматриваемых снимков расположены возле края середины каждой из сторон и представляют собой асимметричные кресты, которые по размеру больше, чем обычные регулярные кресты, идущие с шагом в 1 см.


![Координатная метка снимка](images\Ref03\Mark.png)


Обратите внимание на порядок координатных меток – правая, левая, верхняя, нижняя. Вам нужно расставлять их в таком же порядке. Внизу окна приводится табличка, где выделена строка с активной на данной момент меткой. Как только вы метку установили, автоматически активной становится следующая метка в таблице. Если вам необходимо исправить положение координатной метки, то нужно выделить соответствующую строку в таблице и указать на снимке правильное положение метки.

После расстановки меток нажмите на кнопку ![](images\Ref03\Execute_IO.png). В результате откроется окно отчёта внутреннего ориентирования с вектором параметров и матрицей вариации-ковариации. Если точность операции удовлетворительная, то будет активна кнопка **Accept**, нажав которую, мы сохраняем параметры. После этого нажмите на кнопку **Done** ![](images\Ref03\Done.png), что вернёт вас в основное окно проекта.


![Отчёт внутреннего ориентирования](images\Ref03\IO_Report.png)


Аналогично операция проделывается для всех снимков.


## Опорные точки {#stereo-GCP}
[В начало справки ⇡](#stereo)

Поскольку параметры внешнего ориентирования нам заранее неизвестны, то их необходимо рассчитать на основе обратной фотограмметрической засечки. Для обратной засечки нам потребуются опорные точки с известными координатами и высотами. Откройте в программе **Google Earth Pro** файл **KML** с точками фототриангуляции. Для просмотра нам потребуется снимок QuickBird за 20 апреля 2006 года (как самый хронологически близкий к 1970), который можно включить кнопкой ![](images\Ref03\Hystorical.png).


![Опорные точки на снимке QuickBird за 20 апреля 2006 года](images\Ref03\QB2006.png)


Следует иметь в виду, что координаты этих точек достаточно точно уравнены между собой, но снимок сам по себе может быть аффинно сдвинут на некую постоянную величину. Нам необходимо получить координаты этих точек в проекции UTM. Для переключения показа координат в UTM зайдите в меню **Инструменты – Настройки** и выберите соответствующий пункт в разделе **Показывать шир/долг**.


![Настройки показа координат](images\Ref03\GE_Settings.png)


Теперь, если вы правой кнопкой мыши щёлкните по опорной точке и из меню выберите **Свойства**, перед вами откроется окно с координатами восточного и северного склонения для точки.



## Внешнее ориентирование {#stereo-exterior}
[В начало справки ⇡](#stereo)

Для этого в меню выберите пункт **Execute – Spatial Resection**. Аналогично внутреннему ориентированию откроется окошко с выбором снимка. Далее откроется снимок


----
_Карпачевский А.М._ **Фотограмметрия и основы дистанционного зондирования**. М.: Географический факультет МГУ, `r lubridate::year(Sys.Date())`.
----